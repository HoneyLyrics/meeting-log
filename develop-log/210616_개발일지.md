# 210616 ê°œë°œ ì¼ì§€
## 1. Back-end ê°œë°œ
- FrontEndì™€ ì„œë²„ ì—°ê²° (ìˆ˜í˜„)
  - FrontEndë¡œë¶€í„° GET ìš”ì²­ë°›ì•„ moodidë¼ëŠ” parameterë¥¼ ê°€ì ¸ì˜´
  - DBë¡œë¶€í„° moodidì— í•´ë‹¹í•˜ëŠ” ìŒì•…ì •ë³´ ê²€ìƒ‰
  - jsonìœ¼ë¡œ ë°ì´í„° ì „ì†¡
  - ìƒˆë¡œ ì•Œê²Œëœ ì‚¬ì‹¤
    - Djangoì˜ Allowed HOSTë¡œë¶€í„° ipì£¼ì†Œ, ë„ë©”ì¸ ë„¤ì„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
    - DjangoëŠ” db queryë¥¼ sqlë¬¸ì´ ì•„ë‹Œ ì½”ë“œë¡œ í•  ìˆ˜ ìˆë‹¤.
    ```python
          all_entries = SongInfo.objects.filter(
                mood1__lte=mood,
                mood2__lte=2,
                mood3__lte=3
            )
    ```

- Data ì „ì²˜ë¦¬ (ìˆ˜í˜„, ì±„ì›)
  - ê°€ì‚¬ ë¼ë²¨ë§ ì™„ë£Œ(24ê°œ ê°ì •ìœ¼ë¡œ ê³¡ë³„ ê°ì • 3ê°€ì§€ ë¼ë²¨ë§)
  - ê°€ì‚¬ ì „ì²˜ë¦¬ ì™„ë£Œ
    - ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì ì‚­ì œ
    ```python
    except_string = ['\n','\'', '(',')','â€™','-','â€˜',',','"','.','?','!','~','<','ê°„ì£¼']
    for estr in except_string:
        string = string.replace(estr,' ')
    string = re.compile('[a-zA-Z]*').sub('', string)
    string = re.compile('(([ë‚˜]{2,}|[ìš°]{2,}|[ìŒ ]{2,}))').sub(' ', string)
    string = re.compile('([0-9]+\s+)').sub(' ', string)
    string = re.compile('(\s+)').sub(' ', string)

    ```
    - mood - lyricsë§Œ ê°€ì§€ë„ë¡ ë°ì´í„° ë³€ê²½ ë° ì €ì¥

- training ë°©ë²• ì¡°ì‚¬ (ìˆ˜í˜„)

  - pytorchê¸°ë°˜ koBert ì‚¬ìš© ë° ëª¨ë¸ë§ ì˜ˆì •

- ImageURL í¬ë¡¤ë§ (ì±„ì›)

  - ë…¸ë˜ ì •ë³´ í¬ë¡¤ë§í•œ ê²°ê³¼ë¥¼ ê°€ì ¸ì™€ dataì— ì €ì¥í•˜ëŠ” ì½”ë“œì—ì„œ songIdì— í•´ë‹¹í•˜ëŠ” ì´ë¯¸ì§€ URL íƒœê·¸ë¡œ ê°€ì ¸ì˜¤ê¸°

  - ì½”ë“œ ì¶”ê°€í•œ ë¶€ë¶„ì€ crawlers.pyì˜ parsing_info() í•¨ìˆ˜ì—ì„œ ì•„ë˜ ë¶€ë¶„ì´ë‹¤.

  - í—¤ë§¨ ë¶€ë¶„ì€ ë©œë¡  ì¸¡ì—ì„œ í¬ë¡¤ë§í•˜ëŠ” ê²ƒì´ ì‚¬ëŒì¸ì§€, ë¡œë´‡ì¸ì§€ êµ¬ë¶„ì„ ìœ„í•´ ì¼ì •ë¶€ë¶„ ë§‰ì•„ë‘ì–´ ê³„ì† ì—ëŸ¬ê°€ ë‚¬ëŠ”ë°, User-Agentë¥¼ 'Mozilla/5.0'ìœ¼ë¡œ ì„¤ì •í•´ ì˜µì…˜ìœ¼ë¡œ í•¨ê»˜ ìš”ì²­ ë³´ë‚´ë©´ ì •ìƒ ì‹¤í–‰ëœë‹¤.

    ```python
    from urllib.request import urlopen, Request
    
    url = "https://www.melon.com/song/detail.htm?songId=" + str(song_info["songId"])
            header01 = {'User-Agent': 'Mozilla/5.0'}    # header01ì— Header Informationì„ ë„£ì–´ë‘ 
            html = Request(url, headers=header01)       # Headerì˜ ì†ì„±ì— "header01" ë³€ìˆ˜ë¥¼ ì„ ì–¸í•´ ì¤Œ.
            source = urlopen(html).read()
            soup = BeautifulSoup(source, "html.parser")
            thumb = soup.find("div", {"class": "thumb"})
            imgurl = thumb.find('img')['src']
    data.append(
                {
                "imgUrl": imgurl,
                }
    ```

## 2. Front-end ê°œë°œ
- Footer ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
  ```HTML
    <div className="footer">
      <div className="copyright">
        {Copyright}
      </div>
      <div className="contact-us">
        <div className="title">ğŸ“«contact us!</div>
        <div className="developers">
          {ê°œë°œì ì •ë³´}
        </div>
      </div>
    </div>
  ```
- ê°€ì‚¬ ë¶€ë¶„ fold
  - MusicDetailì˜ ê°€ì‚¬ ë¶€ë¶„ì„ ì ‘ì—ˆë‹¤íˆë‹¤ í•  ìˆ˜ ìˆë‹¤.
    - í•¨ìˆ˜ ë¶€ë¶„
    ```javascript
      const [fold, setFold] = useState(true);
      const handleFoldClick = () => {
        setFold(fold => !fold);
      };
    ```
    - html ë¶€ë¶„
    ```HTML
      <div className="lyrics-info">
        <div className={`song-lyrics ${fold ? '' : 'lyrics-on'}`}>
          {lyricsWithBr}
        </div>
        <button className="fold-button" onClick={handleFoldClick}>
          {fold ? (
            <>
              <span>ë”ë³´ê¸°</span>
              <AiOutlineDown />
            </>
          ) : (
            <>
              <span>ì ‘ê¸°</span>
              <AiOutlineUp />
            </>
          )}
        </button>
      </div>
    ```
- api ì„œë²„ì™€ ì—°ê²°
  - get ë©”ì„œë“œ(/musiclist/?moodid={:moodid}) ë°›ì•„ì˜¤ê¸°
  ```javascript
    useEffect(() => {
      const fn = async () => {
        setLoading(true);
        try {
          const res = await axios.get(`/musiclist/?moodid=${moodid}`);
          setSongs(res.data);
        } catch (e) {
          setError(e);
        }
        setLoading(false);
      };
      fn();
    }, [moodid]);
  ```
